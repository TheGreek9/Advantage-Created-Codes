import pyautogui

def main():
    pyautogui.click(165, 196)

    pyautogui.moveTo(1132, 469, duration=1.5)
    pyautogui.click(1132, 469)
    process('52 Weeks')

    pyautogui.moveTo(830, 380, duration=1.5)
    pyautogui.click(830, 380)
    process('YTD')

    pyautogui.moveTo(1156, 426, duration=1.5)
    pyautogui.click(1156, 426)
    process('26 Weeks')

    pyautogui.moveTo(1152, 388, duration=1.5)
    pyautogui.click(1152, 388)
    process('13 Weeks')

    pyautogui.moveTo(1012, 384, duration=1.5)
    pyautogui.click(1012, 384)
    process('4 Weeks')

    pyautogui.moveTo(848, 200, duration=1.5)
    pyautogui.click(848, 200)
    focus_terminal('Click bump chart. Press enter when finished')
    pyautogui.moveTo(178, 193, duration=1)
    pyautogui.click(178, 193)
    pyautogui.moveTo(830, 380, duration=1.5)
    pyautogui.click(830, 380)
    process('Bump')
    pyautogui.moveTo(290, 193, duration=1.5)
    pyautogui.click(290, 193)
    focus_terminal('Remember products. Press enter when finished.')

    pyautogui.moveTo(848, 200, duration=1.5)
    pyautogui.click(848, 200)
    pyautogui.moveTo(140, 266, duration=1)
    pyautogui.click(140, 266)
    pyautogui.moveTo(138, 346, duration=1)
    pyautogui.click(138, 346)
    pyautogui.moveTo(652, 527, duration=1)
    pyautogui.click(652, 527)
    pyautogui.moveTo(172, 519, duration=1)
    pyautogui.click(172, 519)
    pyautogui.moveTo(1359, 669, duration=1)
    pyautogui.click(1359, 669)
    pyautogui.moveTo(595, 565, duration=1)
    pyautogui.click(595, 565)
    pyautogui.moveTo(299, 194, duration=1)
    pyautogui.click(299, 194)
    focus_terminal('Click Products From Brand. Click enter when finished.')
    pyautogui.moveTo(178, 193, duration=1)
    pyautogui.click(178, 193)
    pyautogui.moveTo(830, 380, duration=1.5)
    pyautogui.click(830, 380)
    process_all("Selling")

    pyautogui.moveTo(848, 200, duration=1.5)
    pyautogui.click(848, 200)
    pyautogui.moveTo(652, 527, duration=1)
    pyautogui.click(652, 527)
    pyautogui.moveTo(179, 506, duration=1)
    pyautogui.click(179, 506)
    pyautogui.moveTo(1359, 669, duration=1)
    pyautogui.click(1359, 669)
    pyautogui.moveTo(595, 565, duration=1)
    pyautogui.click(595, 565)
    pyautogui.moveTo(299, 194, duration=1)
    pyautogui.click(299, 194)
    focus_terminal("Check Products. Click enter when finished.")
    pyautogui.moveTo(178, 193, duration=1)
    pyautogui.click(178, 193)
    pyautogui.moveTo(1012, 384, duration=1.5)
    pyautogui.click(1012, 384)
    process_all("Markdown")

    pyautogui.moveTo(177, 735, duration=1.5)
    pyautogui.click(177, 735)


def process(week):
    pyautogui.moveTo(418, 196, duration=1)
    pyautogui.click(418, 196)
    focus_terminal("Has the report loaded after run report?")
    pyautogui.moveTo(737, 256, duration=1)
    pyautogui.click(737, 256)
    pyautogui.moveTo(886, 386, duration=0.6)
    pyautogui.click(886, 386)
    pyautogui.moveTo(847, 506, duration=0.6)
    pyautogui.click(847, 506)
    focus_terminal("Has the excel file downloaded?")
    pyautogui.moveTo(30, 689, duration=1.5)
    pyautogui.click(30, 689)
    pyautogui.moveTo(89, 324, duration=4)
    pyautogui.click(89, 324); pyautogui.typewrite(week)
    pyautogui.typewrite('\n')
    pyautogui.moveTo(101, 756, duration=1)
    pyautogui.click(101, 756)
    pyautogui.moveTo(435, 259, duration=1)
    pyautogui.click(435, 259)
    pyautogui.moveTo(178, 193, duration=3.2)
    pyautogui.click(178, 193)

def process_all(text):
    pyautogui.moveTo(418, 196, duration=1)
    pyautogui.click(418, 196)
    focus_terminal("Has the report loaded after run report?")
    pyautogui.moveTo(737, 256, duration=1)
    pyautogui.click(737, 256)
    pyautogui.moveTo(852, 344, duration=0.6)
    pyautogui.click(852, 344)
    pyautogui.moveTo(847, 506, duration=0.6)
    pyautogui.click(847, 506)
    focus_terminal("Has the excel file downloaded?")
    pyautogui.moveTo(146, 693, duration=1.5)
    pyautogui.click(146, 693)
    pyautogui.moveTo(89, 324, duration=4)
    pyautogui.click(89, 324); pyautogui.typewrite(text)
    pyautogui.typewrite('\n')
    pyautogui.moveTo(101, 756, duration=1)
    pyautogui.click(101, 756)
    pyautogui.moveTo(178, 193, duration=3.2)
    pyautogui.click(178, 193)

def focus_terminal(text):
    pyautogui.click(966, 756)
    text = input(text)
    pyautogui.click(541, 192)

def check_color(color):
    x, y = pyautogui.position()
    im = pyautogui.screenshot()

    match = pyautogui.pixelMatchesColor(x, y, color)
    try:
        while match == False:
            match = pyautogui.pixelMatchesColor(x, y, color)
    except KeyboardInterrupt:
        focus_terminal("Paused")
        check_color(color)

if __name__ == '__main__':
    main()
